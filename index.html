<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HomePage</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="manifest" href="manifest.json">
    <script src="https://kit.fontawesome.com/7183df4a39.js" crossorigin="anonymous"></script>
</head>
<body>
    <div class="navbar">
        <img src="logo.png" alt="Logo" class="Logo" onclick="window.location.href='index.html'">
        <h1>Anime Viewer</h1>
        <i class="fas fa-history icon" onclick="location.href='history.html';"></i>
    </div>
    <div class="main-container">
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2>Genres</h2>
                <button onclick="closeSidebar()">Hide</button>
            </div>
            <div class="genre-list" id="genre-list"></div>
        </div>
        <div class="content">
            <div class="search-bar">
                <input type="text" id="search-input" placeholder="Search for anime..." oninput="handleSearchInput()">
            </div>
            <h2 id="current-genre">Now Showing: All Anime</h2>
            <div class="section">
                <h2 class="section-title">Latest Episodes</h2>
                <div id="latest-episodes" class="anime-list"></div>
            </div>
            <div class="section">
                <h2 class="section-title">Top Airing Anime</h2>
                <div id="top-airing-anime" class="anime-list"></div>
            </div>
            <div class="section">
                <h2 class="section-title">Popular Movies</h2>
                <div id="popular-movies" class="anime-list"></div>
            </div>
        </div>
    </div>
    <div id="popup-message" class="popup-message"></div>
    <script src="scripts/script.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/service-worker.js').then(function(registration) {
                    console.log('ServiceWorker registration successful with scope: ', registration.scope);
                }, function(error) {
                    console.log('ServiceWorker registration failed: ', error);
                });
            });
        }

        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            const installButton = document.getElementById('install-button');
            installButton.style.display = 'block';
            installButton.addEventListener('click', (e) => {
                installButton.style.display = 'none';
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the install prompt');
                    } else {
                        console.log('User dismissed the install prompt');
                    }
                    deferredPrompt = null;
                });
            });
        });
        const installButtonHTML = `<button id="install-button" style="display: none;">Install App</button>`;
        document.body.insertAdjacentHTML('beforeend', installButtonHTML);
    </script>
</body>
</html>
